<!DOCTYPE html><html><head>
		<title>Working with git hooks.</title>
		<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="assets/Crystal_Clear_app_tux.png" type="image/png">
		<link rel="stylesheet" href="main.css">


		<header>
			<div>
				<!-- 
					<a href="https://trevcan.github.io"> 
				-->
				<a href="index.html">

					<!--
						<h1>trevcan@internets /random/path/idk $</h1>
					-->
					<h1>trevcan@internets /dev/human $</h1>
				</a>
				<div class="header-links">
					<a href="index.html"><h2 class="header-link">Index</h2></a>
					<a href="about.html"><h2 class="header-link">About</h2></a>
					<a href="rss.xml"><h2 class="header-link">RSS</h2></a>
					<a href="atom.xml"><h2 class="header-link"> atom</h2></a>
					<a href="wl.html"><h2 class="header-link">later</h2></a>
				</div>
			</div>
		</header>


	</head><body>

		<div class="container">

	<h1>Working with git hooks.</h1>

	<table>
		<tr>
			<td><i>Posted on:</i></td>
			<td><i>11/14/2021 09:50:43 PM</i></td>

		</tr>
		<tr>
			<td><i>Last edited:</i></td>
			<td><i>11/14/2021 09:52:47 PM</i></td>
		</tr>
	</table>

<p>edit: see end of post.</p>

<p>Hey there fellow read-capable human! I am here to tell you a story about
git hooks. Well, first let&rsquo;s talk a little bit about how remote repos work.</p>

<p>From the little knowledge I think I have, a git server can be run through ssh,
you must create a git user which is in fact the user you login as when pushing
your git object references. Most of the time, this will happen in a bare git
repo. That is, a repo which only contains the contents of what you would
normally expect the
<pre><code>.git
</code></pre>
contents to be. So in fact there&rsquo;s no working directory but only history
changes with reference objects and stuff. But in fact this is probably wrong,
as most people most likely use services such as github.com, gitlab.com,
etcetera. And those websites can show you the files and in fact show you
the &lsquo;working directory&rsquo; of you repo, and the files themselves. So most git
servers you interact with are probably not bare since the aforementioned
services show you the files. So I chose to setup a git server on my home server
, pretty straight forward. Setup some ssh keys to not be spammed or something.
Then I had the amazing idea to migrate my blog over to my home server so I
did it and migrated slowly to <a href="https://pedantic.software/git/blogit">blogit</a>.
Actually, I started my own fork:
<a href="http://github.com/trevcan/blogit">github/trevcan/blogit</a>. So anyways, back to
the actual story.</p>

<p>My blog was doing okay until I started to try building server side. The problem
was that the articles were being messed up in terms of last edited and last
updated dates and I really didn&rsquo;t know what to do. Until I stumbled upon the
fact that having different locales can mess up programs such as the gnu&rsquo;s
coreutils program sort. So yeah, all I had to do was export LC_ALL=C to
make it fix itself.</p>

<p>Then I wantd to find out how to automate this process. Since I could already
push to my own git server, I was able to use git hooks. But after that I kind
of got lost since the commands did execute but the index.html file was never
properly generated. This is due to the fact that git proudly changes some
environment variables because it wants to and barely documented them [0].
So I stumbled upon [1] and then found out all I had to do was add the unset
function to that env variable since blogit uses git magic to figure out the
last updated and last edited things and it though my repo was somehwere else
when it wasn&rsquo;t so yeah. I actually haven&rsquo;t tested it and after I finish
writing this blog post it will be the actual guinea pig to see if it actually
works. You know, so I don&rsquo;t get stuck in the &lsquo;automating somehting for hours
and not do any actual work&rsquo; thing. So I&rsquo;m writing this post as kind of
an obligatory thing since I barely have anything on the blog. I mean, I have
like 20 articles but most of them barely say anything.</p>

<p>Anyways, I&rsquo;m going to track this on git and commit and push I guess.</p>

<a name="references"></a>
<h3>references</h3>

<ul>
<li><a href="https://longair.net/blog/2011/04/09/missing-git-hooks-documentation/">0: Missing git hooks docs</a>

<ul>
<li><a href="https://stackoverflow.com/questions/9228921/git-post-update-script-does-not-work">1: git post update script does not work <em>stackoverflow.com</em></a></li>
</ul>
</li>
<li></li>
</ul>


<p>guess what :( ?? it didn&rsquo;t work. apparently it&rsquo;s not pulling the latest changes
I push for some weird reason and when I pull them as the git user in a shell
it works perfectly fine and detects new changes. i removed some arguments
i had in the git pull command so let&rsquo;s see if that works.</p>

<i> Tags: <b> debugging sysadmin site-update </b></i>
</div>
<footer id=footer >

	<span>
		<!--
			<b>By trevcan : Hector Canizales;</b>
		-->
		<b>By trevcan : Hector Canizales;</b>
	</span>
	<a href="LICENSE">
		<span>© sometime to ∞</span>
	</a>
	<p>
	<span>
		<b>Powered by my </b>
	</span>
	<a href="https://github.com/trevcan/blogit">
		<span>fork of blogit</span>
	</a>
	<span>
		and tocttou's beautiful
	</span>
	<a href="https://github.com/tocttou/hacker-blog/blob/master/_sass/base.scss">
		<span>css</span>
	</a>


</footer>

</body></html>
